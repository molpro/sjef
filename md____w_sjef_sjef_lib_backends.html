<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>sjef: Configuration of backends</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">sjef
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Configuration of backends </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Local and remote jobs are placed through the definition of one or more backends that are defined in a configuration file located at <code>~/.sjef/</code>*suffix*<code>/backends.xml</code> and/or <code>/usr/local/etc/sjef/</code>*suffix*<code>/backends.xml</code>, where <em>suffix</em> is the file extension of the project bundle, and indicates the software package that will run on the backend. The following fields normally need to be specified in order to define the backend.</p>
<ul>
<li><code>name</code> The name to be used as a handle for the backend</li>
<li><code>host</code> Hostname, possibly with user name, for ssh communication with the remote.</li>
</ul>
<p>The following field is optional.</p><ul>
<li><code>cache</code> Directory on the remote that will host the cache. The project is placed within that directory using the absolute path name on the local host, in order to avoid conflicts between projects. Note that the cache path does not contain the host name of the local host, since that can sometimes change, but as a consequence one should be aware of the potential of clashes between projects generated on different machines. If not specified, a sensible default for <code>cache</code> is chosen.</li>
</ul>
<p>If jobs are to be run informally on the remote, this is all that is needed, provided that sjef is found in the path on the remote machine. If jobs are instead to be launched using a batch system, the following additional fields need to be defined.</p><ul>
<li><code>run_command</code> The command used to submit the job. This might simply be the software package executable , possibly appended with some options, or a script file that submits an appropriate batch job to launch the package. At job submission time, the input file name is appended to <code>run_command</code>.</li>
<li><code>run_jobnumber</code> A <a href="http://www.cplusplus.com/reference/regex/ECMAScript/">regular expression</a> that extracts the job number from the output of <code>run_command</code>.</li>
<li><code>kill_command</code> A command that will kill the job, when the job number is appended.</li>
<li><code>status_command</code> A command that will query the status the job, when the job number is appended.</li>
<li><code>status_waiting</code> A <a href="http://www.cplusplus.com/reference/regex/ECMAScript/">regular expression</a> that matches the output of <em>status_command</em> if the job is waiting to run.</li>
<li><code>status_running</code> A <a href="http://www.cplusplus.com/reference/regex/ECMAScript/">regular expression</a> that matches the output of <em>status_command</em> if the job is running.</li>
</ul>
<p>Within the definition of <code>run_command</code>, a simple keyword substitution mechanism is available:</p>
<ul>
<li><code>{prologue textparam!documentation}</code> is replaced by the value of parameter <code>param</code> if it is defined, prefixed by <code>prologue text</code>. Otherwise, the entire contents between <code>{}</code> is elided.</li>
<li><code>{prologue param:default value!documentation}</code> works similarly, with substitution of <code>default value</code> instead of elision if <code>param</code> is not defined. <code>!documentation</code> is ignored in constructing the completed run command, but can be queried by programs using the library, so it is good practice to write a description that would help a user to understand if and how the parameter should be specified.</li>
</ul>
<p>The key/value pairs are normally specified through the library call to run the job (<code><a class="el" href="classsjef_1_1_project.html#a78a8af26654fada8c1b0799aac21c844" title="Start a sjef job.">sjef::Project::run()</a></code>, <code>pysjef.Project.run()</code>, <code>sjef run</code>) but are then cached in the properties of the project using the backend, so that the defaults for subsequent runs for the same project are the values of the parameters used most recently.</p>
<p>Example:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">backends</span>&gt;</div>
<div class="line">  <span class="comment">-&#x2401;&#x2413;æ}U</span></div>
<div class="line"><span class="comment">-&#x2401;&#x2413;æ}U</span></div>
<div class="line"><span class="comment"> ›)‚ı</span></div>
<div class="line"><span class="comment">Ä„)‚ı</span></div>
<div class="line"><span class="comment">  --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">backend</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;local&quot;</span> <span class="keyword">host</span>=<span class="stringliteral">&quot;localhost&quot;</span></div>
<div class="line">           <span class="keyword">run_command</span>=<span class="stringliteral">&quot;molpro {-n %n!MPI size} {-M %M!Total memory} {-m %m!Memory per process} {-G %G!GA memory}&quot;</span></div>
<div class="line">  /&gt;</div>
<div class="line">  <span class="comment">&lt;!-- local backend with special options --&gt;</span></div>
<div class="line">  &lt;<span class="keywordtype">backend</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;special_local&quot;</span> <span class="keyword">host</span>=<span class="stringliteral">&quot;localhost&quot;</span> <span class="keyword">run_command</span>=<span class="stringliteral">&quot;molpro {-n %n:2!MPI size} {-m %m:100M!Memory} {-G %G!GA memory}&quot;</span>/&gt;</div>
<div class="line">  <span class="comment">&lt;!-- informal immediate launching of Molpro on a neighbouring workstation --&gt;</span></div>
<div class="line">    &lt;<span class="keywordtype">backend</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;linux&quot;</span> <span class="keyword">host</span>=<span class="stringliteral">&quot;user@host&quot;</span> <span class="keyword">cache</span>=<span class="stringliteral">&quot;/tmp/sjef-backend&quot;</span> <span class="keyword">run_command</span>=<span class="stringliteral">&quot;molpro&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">backend</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;linux2&quot;</span> <span class="keyword">host</span>=<span class="stringliteral">&quot;linux2&quot;</span> <span class="keyword">cache</span>=<span class="stringliteral">&quot;/tmp/peter/sjef-backend&quot;</span> <span class="keyword">run_command</span>=<span class="stringliteral">&quot;myMolpro/bin/molpro&quot;</span>/&gt;</div>
<div class="line">  <span class="comment">-&#x2401;&#x2413;æ}U</span></div>
<div class="line"><span class="comment">       and submits with srun --&gt;</span></div>
<div class="line">    &lt;<span class="keywordtype">backend</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;slurmcluster&quot;</span></div>
<div class="line">             <span class="keyword">host</span>=<span class="stringliteral">&quot;{%user}@slurmcluster.somewhere.edu&quot;</span></div>
<div class="line">             <span class="keyword">cache</span>=<span class="stringliteral">&quot;/scratch/{%user}/sjef-project&quot;</span></div>
<div class="line">             <span class="keyword">run_command</span>=<span class="stringliteral">&quot;/software/molpro/release/bin/qmolpro {-t %t!time limit in seconds} {-n %n!number of MPI processes} {-m %m!memory} {-G %G!Global Arrays memory} {-q %q:compute!batch queue}&quot;</span></div>
<div class="line">             <span class="keyword">run_jobnumber</span>=<span class="stringliteral">&quot;Submitted batch job *([0-9]+)&quot;</span></div>
<div class="line">             <span class="keyword">kill_command</span>=<span class="stringliteral">&quot;scancel&quot;</span></div>
<div class="line">             <span class="keyword">status_command</span>=<span class="stringliteral">&quot;squeue -j&quot;</span></div>
<div class="line">             <span class="keyword">status_running</span>=<span class="stringliteral">&quot; (CF|CG|R|ST|S) *[0-9]&quot;</span> <span class="keyword">status_waiting</span>=<span class="stringliteral">&quot; (PD|SE) *[0-9]&quot;</span></div>
<div class="line">    /&gt;</div>
<div class="line">&lt;/<span class="keywordtype">backends</span>&gt;</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Sep 5 2022 09:00:41 for sjef by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
